<h2>Lista de Estudiantes</h2>

<!-- Información de depuración -->
<p>Token: {{ auth.obtenerToken() }}</p>
<p>Roles: {{ auth.obtenerRoles() | json }}</p>
<p>Rol del usuario: {{ auth.obtenerRolUsuario() }}</p>

<!-- Crear (solo ADMIN) -->
<button *ngIf="auth.tieneRol('ADMIN')" [routerLink]="['/crear']">
  Crear Estudiante
</button>

<!-- Logout -->
<button (click)="logout()">Cerrar sesión</button>

<ul>
  <li *ngFor="let e of estudiantes">
    {{ e.nombre }} - {{ e.email }} - {{ e.edad }} - {{ e.telefono }}

    <!-- Editar (solo ADMIN) -->
    <button *ngIf="auth.tieneRol('ADMIN')" [routerLink]="['/editar', e.id]">
      Editar
    </button>

    <!-- Eliminar (solo ADMIN) -->
    <button
      *ngIf="auth.tieneRol('ADMIN')"
      (click)="eliminarEstudiante(e.id)"
      [disabled]="isDeletingId === e.id">

      <span *ngIf="isDeletingId === e.id">Eliminando...</span>
      <span *ngIf="isDeletingId !== e.id">Eliminar</span>
    </button>

    <!-- Ver detalle -->
    <button [routerLink]="['/detalle', e.id]">Ver detalle</button>
  </li>
</ul>

<!-- Error -->
<p *ngIf="errorMensaje" style="color:red">{{ errorMensaje }}</p>
